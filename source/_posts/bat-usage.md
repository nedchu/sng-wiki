---
title: Batch基础教程
date: 2017-11-26 19:30:53
tags: [batch]
---
> Work In Progress

> 本文介绍了Batch的基本知识，基本命令。通过这些知识构建NOIP竞赛中能够使用的验证程序。正式比赛中编写该程序以降低在现场赛中发生低级错误的可能性。

<!-- more -->
# 基本知识
## 什么是Batch
Batch文件又称为批处理文件，以`.bat`为后缀，是一种能够被DOS系统中的命令行(cmd.exe)运行的脚本文件。其作用和地位类似于Unix系统中的Shell脚本。学会使用批处理/Shell能够更好地使用操作系统交互，实现许多用户界面程序不会提供的功能。除了基本的命令之外，Batch还支持`IF,FOR,GOTO`等分支操作，不过本文中不会涉及，有兴趣的同学可以自行学习。

我们可以在命令行之中直接编写Batch命令，回车去运行，也可以写入`.bat`文件中之后再运行。

在NOIP竞赛中一般不会涉及Batch编程，但是利用批处理的技术，我们可以很好地检查文件命名是否正确，是否通过样例，更进一步的，我们也可以使用Batch进行自动对拍。


## 新建Batch
在文件夹选项中选择不隐藏扩展名之后，直接新建文本重命名为`.bat`文件即可。可以编写好之后再重命名，也可以右键文件使用记事本或者其他编辑器进行编辑，比较推荐使用Notepad++。

Batch和其他代码一样都是文本文件。


## 打开命令行
第一种打开命令行的方式是`Win+R`输入`cmd`或者`powershell`，当不需要使用具体文件夹的文件时使用这种方式比较好。

第二种打开命令行的方式可以直接在具体文件中打开。在文件夹空白处`Shift+右键`，打开菜单，Win10中单击**在此处打开Powershell窗口**或者Win7/8中单击**在此处打开命令行**打开命令行窗口。


## 运行Batch
最简单的是双击直接运行`.bat`文件，也可以在命令行中利用命令直接运行。

假如文件夹下有程序`run.bat`那运行以下命令均可以运行该程序：
``` bat
run
run.bat
```

如果将`run.bat`所在的路径加入到环境变量**Path**中则可以在任意路径下直接运行该程序。


## Path
**Path**是Windows系统的环境变量，在命令行中若当前路径下没有找到需要的程序，Windows系统就会在**Path**中进一步进行寻找。常用的程序或者自己写出的工具可以加入**Path**中以随时随地方便使用。向**Path**新增路径的步骤为：

1. 打开我的电脑->右键我的电脑->属性
2. 高级系统设置->环境变量
3. 修改用户环境变量中的**Path**，Win10中新建输入即可，Win7/8中加入`;`然后加上新路径

## 练习
- 尝试使用两种方式打开命令行，尝试对某个文件夹`Shift+右键`打开命令行，进行观察
- 新建一个`.bat`程序，输入`echo "Hello, World!"`，尝试运行
- 尝试将本机中的g++编译器，将它所在的文件夹加入到**Path**中，运行命令行输入`g++ -v`检测

# Batch基本命令
## 帮助命令
帮助命令是十分重要的命令，学会帮助命令之后可以在命令行中自行查看工具的使用方法。以下命令为帮助命令的基本使用：
``` bat
help
cd /?
help cd
```

第一行的`help`命令会显示所有的基本命令和解释，后两行命令会显示`cd`命令的使用方法，`help`中显示的命令均可以利用后两行的命令显示使用方法，许多命令行程序也会提供基本的帮助。

## echo命令
**echo**就是回声的意思，后面跟上一个字符串时候就会直接输出后面这个字符串。

运行`.bat`程序的时候，程序会在命令行中再输出一遍所有执行的命令。如果在`.bat`中输入`@echo off`，这些命令就不会再输出了。

``` bat
@echo off
echo sss
help
```

后两句的命令本身不会被输出到命令行中，但是它们执行后的结果仍然会被输出到命令行中。

## fc命令
**fc**就是file compare，能够比较两个文件的差异，在Unix下对应的程序为**diff**，fc能够传入两个参数，即两个需要比较的文件的路径。

``` bat
@echo off
fc a.txt b.txt
if errorlevel 1 (
    echo different
) else (
    echo same
)
pause
```

上面这段代码能够比较`a.txt`和`b.txt`两个文件，如果两个文件不同就输出`different`否则输出`same`，其中`errorlevel`为0是相同，而上面的`if errorlevel 1`是看`errorlevel`是否大于等于1。**注意`else`不可以再换行**。

## 变量
Batch中变量赋值通过`set`进行，默认为字符串，可以通过`/a`指定是整数，变量通过在两边加`%`来使用。
``` bat
@echo off
set a=111
echo %a%.cpp
set /a b = 5
set /a b = %b% + 1
echo %b%
pause

===
111.cpp
6
```
上面这段代码赋值了变量`a`然后接上`.cpp`后输出，然后赋值`b`为整数5，加一后输出。可以看出Batch当中字符串直接写在一起就是连接了。**注意字符串赋值的时候等号两边不能加空格。**

## 函数

## g++

## 练习


# 实用程序的构建
## 